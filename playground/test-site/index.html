<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Show Password Extension Playground</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        margin: 0 auto;
        padding: 2rem;
        max-width: 720px;
        line-height: 1.5;
        background: #f5f5f5;
      }

      h1,
      h2 {
        color: #111827;
      }

      section {
        background: #ffffff;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      input[type='password'],
      input[type='text'] {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.2s ease;
      }

      input:focus {
        outline: none;
        border-color: #2563eb;
        box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.15);
      }

      .native-wrapper {
        position: relative;
      }

      .native-toggle {
        position: absolute;
        top: 50%;
        right: 0.75rem;
        transform: translateY(-50%);
        background: transparent;
        border: none;
        color: #2563eb;
        cursor: pointer;
        font-weight: 600;
      }

      .notes {
        margin-top: 0.75rem;
        font-size: 0.9rem;
        color: #4b5563;
      }
    </style>
  </head>
  <body>
    <h1>Playground: Show Password Toggle Extension</h1>
    <p>
      Usa esta página para verificar el comportamiento de la extensión. Abre DevTools para observar
      la consola del content script cuando alternes los campos.
    </p>

    <section>
      <h2>Formulario sin toggle nativo</h2>
      <p class="notes">La extensión debería inyectar su icono de ojo en estos campos.</p>
      <form>
        <label for="login-password">Contraseña</label>
        <input id="login-password" type="password" autocomplete="current-password" />
      </form>
    </section>

    <section>
      <h2>Formulario con toggle proporcionado por la página</h2>
      <p class="notes">
        El botón “Mostrar” es nativo de la página, por lo que la extensión debe respetarlo y no añadir otro.
      </p>
      <form>
        <label for="native-password">Contraseña</label>
        <div class="native-wrapper">
          <input id="native-password" type="password" autocomplete="new-password" />
          <button id="native-password-toggle" type="button" class="native-toggle" aria-label="Mostrar contraseña">
            Mostrar
          </button>
        </div>
      </form>
    </section>

    <section>
      <h2>Campos dinámicos (simulan SPA)</h2>
      <p class="notes">
        Pulsa en “Añadir campo” para inyectar inputs con y sin toggles. La extensión debería detectarlos
        mediante el MutationObserver.
      </p>
      <div id="dynamic-container"></div>
      <div style="display: flex; gap: 1rem; margin-top: 1rem;">
        <button type="button" id="add-plain">Añadir campo sin toggle</button>
        <button type="button" id="add-native">Añadir campo con toggle</button>
      </div>
    </section>

    <script>
      const nativePasswordToggle = document.getElementById('native-password');
      const nativePasswordToggleButton = document.getElementById('native-password-toggle');

      nativePasswordToggleButton.addEventListener('click', () => {
        const isPassword = nativePasswordToggle.type === 'password';
        nativePasswordToggle.type = isPassword ? 'text' : 'password';
        nativePasswordToggleButton.textContent = isPassword ? 'Ocultar' : 'Mostrar';
      });

      const dynamicContainer = document.getElementById('dynamic-container');
      const addPlain = document.getElementById('add-plain');
      const addNative = document.getElementById('add-native');

      addPlain.addEventListener('click', () => {
        const wrapper = document.createElement('div');
        wrapper.style.marginTop = '1rem';

        const label = document.createElement('label');
        label.textContent = 'Contraseña dinámica';
        label.setAttribute('for', `dyn-${Date.now()}`);

        const input = document.createElement('input');
        input.type = 'password';
        input.id = label.getAttribute('for');

        wrapper.append(label, input);
        dynamicContainer.append(wrapper);
      });

      addNative.addEventListener('click', () => {
        const wrapper = document.createElement('div');
        wrapper.style.marginTop = '1rem';

        const label = document.createElement('label');
        label.textContent = 'Contraseña dinámica con toggle nativo';
        label.setAttribute('for', `dyn-native-${Date.now()}`);

        const container = document.createElement('div');
        container.className = 'native-wrapper';

        const input = document.createElement('input');
        input.type = 'password';
        input.id = label.getAttribute('for');

        const button = document.createElement('button');
        button.type = 'button';
        button.className = 'native-toggle';
        button.setAttribute('aria-label', 'Mostrar contraseña');
        button.textContent = 'Mostrar';

        button.addEventListener('click', () => {
          const isPassword = input.type === 'password';
          input.type = isPassword ? 'text' : 'password';
          button.textContent = isPassword ? 'Ocultar' : 'Mostrar';
        });

        container.append(input, button);
        wrapper.append(label, container);
        dynamicContainer.append(wrapper);
      });
    </script>
  </body>
</html>
